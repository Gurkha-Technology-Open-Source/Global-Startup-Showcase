let allStartups=[],filteredStartups=[],currentPage=1;const startupsPerPage=12;let fuse;const startupsGrid=document.getElementById("startupsGrid"),searchInput=document.getElementById("searchInput"),categoryFilter=document.getElementById("categoryFilter"),countryFilter=document.getElementById("countryFilter"),regionFilter=document.getElementById("regionFilter"),sortFilter=document.getElementById("sortFilter"),resultsCount=document.getElementById("resultsCount"),noResults=document.getElementById("noResults"),resetFiltersBtn=document.getElementById("resetFilters"),loadMoreBtn=document.getElementById("loadMoreBtn"),loadMoreContainer=document.getElementById("loadMoreContainer"),loadedCount=document.getElementById("loadedCount"),darkModeToggle=document.getElementById("darkModeToggle"),savedTheme=localStorage.getItem("darkMode"),systemPrefersDark=window.matchMedia("(prefers-color-scheme: dark)").matches;function updateDarkModeButton(){const e=document.documentElement.classList.contains("dark"),t=darkModeToggle.querySelector("i");e?(darkModeToggle.setAttribute("aria-pressed","true"),t&&(t.className="fas fa-sun mr-2")):(darkModeToggle.setAttribute("aria-pressed","false"),t&&(t.className="fas fa-moon mr-2"))}async function init(){try{showPreloader(),await loadStartups(),initializeFuse(),populateFilters(),displayStartups(allStartups),setupEventListeners(),initializeCharts(),hidePreloader(),announceToScreenReader("Startup showcase loaded successfully")}catch(e){console.error("Error initializing app:",e),hidePreloader(),showError("Failed to load startups. Please check your internet connection and try refreshing the page."),announceToScreenReader("Error loading startups. Please try refreshing the page.")}}function showPreloader(){const e=document.getElementById("preloader");e.classList.remove("hidden"),e.setAttribute("aria-hidden","false")}function hidePreloader(){const e=document.getElementById("preloader");e.classList.add("hidden"),e.setAttribute("aria-hidden","true")}function showError(e){resultsCount.textContent=e,resultsCount.classList.add("text-red-600","font-semibold"),resultsCount.setAttribute("role","alert")}function announceToScreenReader(e){const t=document.createElement("div");t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.className="sr-only",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{document.body.removeChild(t)},1e3)}async function loadStartups(){try{const e=await fetch("data/startups.json");if(!e.ok)throw new Error("Failed to fetch startups data");allStartups=await e.json(),filteredStartups=[...allStartups]}catch(e){throw console.error("Error loading startups:",e),e}}function initializeFuse(){fuse=new Fuse(allStartups,{keys:[{name:"name",weight:2},{name:"description",weight:1.5},{name:"category",weight:1.2},{name:"country",weight:1},{name:"region",weight:1},{name:"founders",weight:.8},{name:"investors",weight:.8}],threshold:.4,ignoreLocation:!0,useExtendedSearch:!1,includeScore:!0})}function populateFilters(){const e=[...new Set(allStartups.map(e=>e.category))].sort(),t=[...new Set(allStartups.map(e=>e.country))].sort(),r=[...new Set(allStartups.map(e=>e.region))].sort();populateDropdown(categoryFilter,e),populateDropdown(countryFilter,t),populateDropdown(regionFilter,r)}function populateDropdown(e,t){t.forEach(t=>{const r=document.createElement("option");r.value=t,r.textContent=t,e.appendChild(r)})}function displayStartups(e){if(startupsGrid.innerHTML="",currentPage=1,0===e.length)return noResults.classList.remove("hidden"),startupsGrid.classList.add("hidden"),loadMoreContainer.classList.add("hidden"),resultsCount.textContent="No startups found matching your criteria.",resultsCount.classList.remove("text-red-600","font-semibold"),resultsCount.removeAttribute("role"),void announceToScreenReader("No startups found matching your search criteria");noResults.classList.add("hidden"),startupsGrid.classList.remove("hidden"),resultsCount.classList.remove("text-red-600","font-semibold"),resultsCount.removeAttribute("role"),loadMoreStartups(e)}function addConsolidatedStructuredData(e){const t=document.querySelector('script[type="application/ld+json"]');t&&t.remove();const r={"@context":"https://schema.org","@type":"ItemList",itemListElement:e.map((e,t)=>({"@type":"ListItem",position:t+1,item:{"@type":"Organization",name:e.name,description:e.description,url:e.website,logo:e.logo}}))},a=document.createElement("script");a.type="application/ld+json",a.textContent=JSON.stringify(r),document.head.appendChild(a)}function createStartupCard(e){const t=document.createElement("div");t.className="bg-white rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 ease-in-out dark:bg-gray-800",t.setAttribute("role","article"),t.setAttribute("aria-labelledby",`startup-name-${e.id}`),t.setAttribute("tabindex","0"),t.dataset.category=e.category,t.dataset.country=e.country,t.dataset.region=e.region;const r=document.createElement("div");r.className="startup-logo dark:bg-gray-700";const a=document.createElement("img");a.src=e.logo,a.alt=`${e.name} company logo`,a.loading="lazy",a.decoding="async",a.referrerPolicy="no-referrer",a.sizes="(min-width: 1280px) 25vw, (min-width: 768px) 33vw, 100vw",a.onerror=function(){this.src="assets/logos/placeholder.svg",this.alt="Company logo placeholder"},r.appendChild(a);const n=document.createElement("div");n.className="startup-content";const o=document.createElement("h3");o.className="startup-name dark:text-white",o.id=`startup-name-${e.id}`,o.textContent=e.name;const s=document.createElement("div");s.className="startup-location dark:text-gray-400",s.textContent=`${e.country} - ${e.region}`;const l=document.createElement("span");l.className="startup-category dark:bg-blue-900 dark:text-blue-200",l.textContent=e.category,l.setAttribute("aria-label",`Category: ${e.category}`);const i=document.createElement("p"),d=`startup-description-${e.id}`;if(i.className="startup-description dark:text-gray-300",i.id=d,i.textContent=e.description,n.appendChild(o),n.appendChild(s),n.appendChild(l),n.appendChild(i),t.setAttribute("aria-describedby",d),e.founded){const t=document.createElement("div");t.className="startup-info dark:text-gray-400",t.innerHTML=`<strong>Founded:</strong> ${e.founded}`,n.appendChild(t)}if(e.founders&&e.founders.length>0){const t=document.createElement("div");t.className="startup-info dark:text-gray-400",t.innerHTML=`<strong>Founders:</strong> ${e.founders.join(", ")}`,n.appendChild(t)}if(e.funding){const t=document.createElement("div");t.className="startup-info dark:text-gray-400",t.innerHTML=`<strong>Funding:</strong> ${e.funding}`,n.appendChild(t)}if(e.investors&&e.investors.length>0){const t=document.createElement("div");t.className="startup-info dark:text-gray-400",t.innerHTML=`<strong>Investors:</strong> ${e.investors.join(", ")}`,n.appendChild(t)}const c=document.createElement("div");if(c.className="startup-links dark:border-gray-700",c.setAttribute("role","list"),c.setAttribute("aria-label",`${e.name} online presence`),e.website){const t=document.createElement("a");t.href=e.website,t.className="social-link dark:border-gray-600 dark:hover:bg-gray-700",t.target="_blank",t.rel="noopener noreferrer",t.setAttribute("aria-label",`Visit ${e.name} website (opens in new tab)`),t.setAttribute("role","listitem");const r=document.createElement("img");r.src="assets/socials/website.svg",r.alt="",r.className="social-icon",r.loading="lazy",r.decoding="async",r.setAttribute("aria-hidden","true"),t.appendChild(r),c.appendChild(t)}return e.socials&&Object.entries(e.socials).forEach(([t,r])=>{const a=document.createElement("a");a.href=r,a.className="social-link dark:border-gray-600 dark:hover:bg-gray-700",a.target="_blank",a.rel="noopener noreferrer",a.setAttribute("aria-label",`Visit ${e.name} on ${t} (opens in new tab)`),a.setAttribute("role","listitem");const n=document.createElement("img");n.src=`assets/socials/${t}.svg`,n.alt="",n.className="social-icon",n.loading="lazy",n.decoding="async",n.setAttribute("aria-hidden","true"),a.appendChild(n),c.appendChild(a)}),n.appendChild(c),t.appendChild(r),t.appendChild(n),t}function filterStartups(){const e=searchInput.value.trim(),t=categoryFilter.value,r=countryFilter.value,a=regionFilter.value,n=sortFilter.value,o=t.toLowerCase(),s=r.toLowerCase(),l=a.toLowerCase();let i;if(""===e)i=allStartups;else{i=fuse.search(e).map(e=>e.item)}switch(filteredStartups=i.filter(e=>{const n="all"===t||e.category.toLowerCase()===o,i="all"===r||e.country.toLowerCase()===s,d="all"===a||e.region.toLowerCase()===l;return n&&i&&d}),n){case"name-asc":filteredStartups.sort((e,t)=>e.name.localeCompare(t.name));break;case"name-desc":filteredStartups.sort((e,t)=>t.name.localeCompare(e.name));break;case"founded-asc":filteredStartups.sort((e,t)=>e.founded-t.founded);break;case"founded-desc":filteredStartups.sort((e,t)=>t.founded-e.founded);break;default:console.warn(`Unexpected sort value: "${n}". No sorting applied.`)}displayStartups(filteredStartups),updateResultsCount(filteredStartups.length)}function loadMoreStartups(e){const t=12*(currentPage-1),r=t+12;e.slice(t,r).forEach(e=>{const t=createStartupCard(e);startupsGrid.appendChild(t)}),currentPage++,r>=e.length?loadMoreContainer.classList.add("hidden"):loadMoreContainer.classList.remove("hidden"),updateLoadedCount()}function resetFilters(){searchInput.value="",categoryFilter.value="all",countryFilter.value="all",regionFilter.value="all",sortFilter.value="name-asc",filterStartups(),searchInput.focus({preventScroll:!0}),announceToScreenReader("All filters cleared. Showing every startup.")}function updateLoadedCount(){const e=startupsGrid.children.length,t=filteredStartups.length;loadedCount.textContent=`Showing ${e} of ${t} startups`}function updateResultsCount(e){const t=allStartups.length,r=searchInput.value.trim(),a=[];r&&a.push(`Search: "${r}"`),"all"!==categoryFilter.value&&a.push(`Category: ${categoryFilter.value}`),"all"!==countryFilter.value&&a.push(`Country: ${countryFilter.value}`),"all"!==regionFilter.value&&a.push(`Region: ${regionFilter.value}`);const n=e===t?`Showing all ${t} startup${1!==t?"s":""}`:`Showing ${e} of ${t} startup${1!==t?"s":""}`,o=a.length>0?` (Filters active: ${a.join(", ")})`:"";resultsCount.textContent=`${n}${o}`}function setupEventListeners(){let e;searchInput.addEventListener("input",()=>{clearTimeout(e),e=setTimeout(filterStartups,300)}),categoryFilter.addEventListener("change",filterStartups),countryFilter.addEventListener("change",filterStartups),regionFilter.addEventListener("change",filterStartups),sortFilter.addEventListener("change",filterStartups),resetFiltersBtn&&resetFiltersBtn.addEventListener("click",resetFilters),loadMoreBtn&&loadMoreBtn.addEventListener("click",()=>loadMoreStartups(filteredStartups)),startupsGrid.addEventListener("keydown",handleCardKeydown);const t=document.getElementById("scrollToTopBtn");window.addEventListener("scroll",()=>{window.pageYOffset>300?t.classList.remove("hidden"):t.classList.add("hidden")}),t.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"}),t.blur()})}function handleCardKeydown(e){const t=Array.from(startupsGrid.querySelectorAll(".startup-card")),r=t.indexOf(e.target.closest(".startup-card"));if(-1!==r)switch(e.key){case"ArrowRight":e.preventDefault();t[(r+1)%t.length].focus();break;case"ArrowLeft":e.preventDefault();t[0===r?t.length-1:r-1].focus();break;case"Home":e.preventDefault(),t[0].focus();break;case"End":e.preventDefault(),t[t.length-1].focus()}}("enabled"===savedTheme||!savedTheme&&systemPrefersDark)&&(document.documentElement.classList.add("dark"),updateDarkModeButton()),darkModeToggle.addEventListener("click",()=>{document.documentElement.classList.toggle("dark"),updateDarkModeButton(),document.documentElement.classList.contains("dark")?localStorage.setItem("darkMode","enabled"):localStorage.setItem("darkMode","disabled"),updateChartsTheme(),announceToScreenReader("Dark mode "+(document.documentElement.classList.contains("dark")?"enabled":"disabled"))});let charts={category:null,country:null,region:null,year:null};function initializeCharts(){if("undefined"==typeof Chart)return void console.warn("Chart.js not loaded. Charts will not be displayed.");const e=document.documentElement.classList.contains("dark"),t=e?"#e5e7eb":"#374151",r=e?"#4b5563":"#e5e7eb";createCategoryChart(t,r),createCountryChart(t,r),createRegionChart(t,r),createYearChart(t,r),setupToggleCharts()}function createCategoryChart(e,t){const r=document.getElementById("categoryChart");if(!r)return;const a={};allStartups.forEach(e=>{a[e.category]=(a[e.category]||0)+1});const n=Object.keys(a).sort(),o=n.map(e=>a[e]);charts.category&&charts.category.destroy(),charts.category=new Chart(r,{type:"bar",data:{labels:n,datasets:[{label:"Number of Startups",data:o,backgroundColor:"rgba(59, 130, 246, 0.7)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(e){return`${e.parsed.y} startup${1!==e.parsed.y?"s":""}`}}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1,color:e},grid:{color:t}},x:{ticks:{color:e},grid:{color:t}}}}})}function createCountryChart(e,t){const r=document.getElementById("countryChart");if(!r)return;const a={};allStartups.forEach(e=>{a[e.country]=(a[e.country]||0)+1});const n=Object.keys(a).sort((e,t)=>a[t]-a[e]).slice(0,10),o=n.map(e=>a[e]),s=["rgba(59, 130, 246, 0.8)","rgba(16, 185, 129, 0.8)","rgba(251, 146, 60, 0.8)","rgba(139, 92, 246, 0.8)","rgba(236, 72, 153, 0.8)","rgba(245, 158, 11, 0.8)","rgba(14, 165, 233, 0.8)","rgba(34, 197, 94, 0.8)","rgba(168, 85, 247, 0.8)","rgba(239, 68, 68, 0.8)"];charts.country&&charts.country.destroy(),charts.country=new Chart(r,{type:"doughnut",data:{labels:n,datasets:[{data:o,backgroundColor:s,borderColor:s.map(e=>e.replace("0.8","1")),borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{position:"right",labels:{color:e,padding:10,font:{size:11}}},tooltip:{callbacks:{label:function(e){const t=e.label||"",r=e.parsed||0;return`${t}: ${r} (${(r/e.dataset.data.reduce((e,t)=>e+t,0)*100).toFixed(1)}%)`}}}}}})}function createRegionChart(e,t){const r=document.getElementById("regionChart");if(!r)return;const a={};allStartups.forEach(e=>{a[e.region]=(a[e.region]||0)+1});const n=Object.keys(a).sort((e,t)=>a[t]-a[e]),o=n.map(e=>a[e]),s=["rgba(59, 130, 246, 0.8)","rgba(16, 185, 129, 0.8)","rgba(251, 146, 60, 0.8)","rgba(139, 92, 246, 0.8)","rgba(236, 72, 153, 0.8)","rgba(245, 158, 11, 0.8)"];charts.region&&charts.region.destroy(),charts.region=new Chart(r,{type:"pie",data:{labels:n,datasets:[{data:o,backgroundColor:s,borderColor:s.map(e=>e.replace("0.8","1")),borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{position:"right",labels:{color:e,padding:10,font:{size:12}}},tooltip:{callbacks:{label:function(e){const t=e.label||"",r=e.parsed||0;return`${t}: ${r} (${(r/e.dataset.data.reduce((e,t)=>e+t,0)*100).toFixed(1)}%)`}}}}}})}function createYearChart(e,t){const r=document.getElementById("yearChart");if(!r)return;const a={};allStartups.forEach(e=>{e.founded&&(a[e.founded]=(a[e.founded]||0)+1)});const n=Object.keys(a).sort((e,t)=>e-t),o=n.map(e=>a[e]);charts.year&&charts.year.destroy(),charts.year=new Chart(r,{type:"line",data:{labels:n,datasets:[{label:"Startups Founded",data:o,backgroundColor:"rgba(59, 130, 246, 0.2)",borderColor:"rgba(59, 130, 246, 1)",borderWidth:2,fill:!0,tension:.4,pointRadius:4,pointBackgroundColor:"rgba(59, 130, 246, 1)"}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{display:!1},tooltip:{callbacks:{label:function(e){return`${e.parsed.y} startup${1!==e.parsed.y?"s":""} founded`}}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1,color:e},grid:{color:t}},x:{ticks:{color:e},grid:{color:t}}}}})}function setupToggleCharts(){const e=document.getElementById("toggleCharts"),t=document.getElementById("chartsContainer");e&&t&&e.addEventListener("click",()=>{const r=t.classList.toggle("hidden");e.setAttribute("aria-expanded",!r);const a=e.querySelector("i"),n=e.querySelector("span");r?(a.className="fas fa-chevron-down",n.textContent="Show Charts"):(a.className="fas fa-chevron-up",n.textContent="Hide Charts")})}function updateChartsTheme(){if("undefined"==typeof Chart||!allStartups.length)return;const e=document.documentElement.classList.contains("dark"),t=e?"#e5e7eb":"#374151",r=e?"#4b5563":"#e5e7eb";Object.values(charts).forEach(e=>{e&&(e.options.scales&&(e.options.scales.y&&(e.options.scales.y.ticks.color=t,e.options.scales.y.grid.color=r),e.options.scales.x&&(e.options.scales.x.ticks.color=t,e.options.scales.x.grid.color=r)),e.options.plugins&&e.options.plugins.legend&&e.options.plugins.legend.labels&&(e.options.plugins.legend.labels.color=t),e.update())})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",init):init();